#
# Automatically generated configuration.
# Do not edit this file manually.

{% if helpers.exists('HWasly.ZabbixAgent.settings') %}

############ GENERAL PARAMETERS #################

PidFile=/var/run/zabbix/zabbix_agentd.pid

{% if helpers.exists('HWasly.ZabbixAgent.settings.main.syslogEnable') and HWasly.ZabbixAgent.settings.main.syslogEnable|default('0') == '1' %}
LogType=system
{% else %}
LogType=file
LogFile=/var/log/zabbix/zabbix_agentd.log
LogFileSize={{HWasly.ZabbixAgent.settings.main.logFileSize}}
{% endif %}

DebugLevel={{HWasly.ZabbixAgent.settings.main.debugLevel|replace("val_", "")}}

{% if helpers.exists('HWasly.ZabbixAgent.settings.main.sourceIP') %}
SourceIP={{HWasly.ZabbixAgent.settings.main.sourceIP}}
{% endif %}

{% if HWasly.ZabbixAgent.settings.features.enableRemoteCommands|default("") == '1' %}
AllowKey=system.run[*]
{% else %}
DenyKey=system.run[*]
{% endif %}
LogRemoteCommands={{HWasly.ZabbixAgent.settings.features.logRemoteCommands}}

Server={{HWasly.ZabbixAgent.settings.main.serverList}}
ListenPort={{HWasly.ZabbixAgent.settings.main.listenPort}}
ListenIP={{HWasly.ZabbixAgent.settings.main.listenIP}}

{% if HWasly.ZabbixAgent.settings.features.enableActiveChecks == '1' and HWasly.ZabbixAgent.settings.features.activeCheckServers|default("") != "" %}
ServerActive={{HWasly.ZabbixAgent.settings.features.activeCheckServers}}
{% endif %}

{% if HWasly.ZabbixAgent.local.hostname|default("") != "" %}
Hostname={{HWasly.ZabbixAgent.local.hostname}}
{% endif %}

StartAgents={{HWasly.ZabbixAgent.settings.tuning.startAgents}}
RefreshActiveChecks={{HWasly.ZabbixAgent.settings.features.refreshActiveChecks}}
BufferSend={{HWasly.ZabbixAgent.settings.tuning.bufferSend}}
BufferSize={{HWasly.ZabbixAgent.settings.tuning.bufferSize}}
MaxLinesPerSecond={{HWasly.ZabbixAgent.settings.tuning.maxLinesPerSecond}}

{% if HWasly.ZabbixAgent.settings.features.encryption == '1' %}
{%   if HWasly.ZabbixAgent.settings.features.encryptionidentity != '' %}
{%     if HWasly.ZabbixAgent.settings.features.encryptionpsk != '' %}
TLSAccept=psk
TLSConnect=psk
TLSPSKFile=/usr/local/etc/zabbix_agent.psk
TLSPSKIdentity={{ HWasly.ZabbixAgent.settings.features.encryptionidentity }}
{%     endif %}
{%   endif %}
{% endif %}

############ ADVANCED PARAMETERS #################

{% if helpers.exists('HWasly.ZabbixAgent.aliases') %}
{%   for alias in helpers.toList('HWasly.ZabbixAgent.aliases.alias') %}
{%     if alias.enabled == '1' %}
{%       if alias.acceptParams == '1' %}
{%         set alias_opts = '[*]' %}
{%       endif %}
Alias={{alias.key}}{{alias_opts}}:{{alias.sourceKey}}
{%     endif %}
{%   endfor %}
{% endif %}

Timeout={{HWasly.ZabbixAgent.settings.tuning.timeout}}
AllowRoot=0
User=zabbix
Include=/usr/local/etc/zabbix_agentd.conf.d

####### USER-DEFINED MONITORED PARAMETERS #######

{% if helpers.exists('HWasly.ZabbixAgent.userparameters') %}
{%   for userparam in helpers.toList('HWasly.ZabbixAgent.userparameters.userparameter') %}
{%     if userparam.enabled == '1' %}
{%       if userparam.acceptParams == '1' %}
{%         set userparam_opts = '[*]' %}
{%       endif %}
UserParameter={{userparam.key}}{{userparam_opts}},{{userparam.command}}
{%     endif %}
{%   endfor %}
{% endif %}

{% endif %}
